---
page_title: "spectrocloud_cluster_custom_cloud Resource - terraform-provider-spectrocloud"
subcategory: ""
description: |-
  Resource for managing custom cloud clusters in Spectro Cloud through Palette.
---

# spectrocloud_cluster_custom_cloud (Resource)

  Resource for managing custom cloud clusters in Spectro Cloud through Palette.

## Example Usage

```terraform
    data "spectrocloud_cloudaccount_custom" "nutanix_account" {
      name  = "test-tf-demo"
      cloud = "nutanix"
    }

    data "spectrocloud_cluster_profile" "profile" {
      name    = "test-tf-ntix-profile"
      context = "tenant"
    }


    resource "spectrocloud_cluster_custom_cloud" "cluster_nutanix" {
      name             = local.cloud_config_override_variables.CLUSTER_NAME
      cloud            = "nutanix"
      context          = "tenant"
      tags             = ["dev", "department:tf", "owner:admin"]
      description      = "The nutanix cluster with k8 infra profile test"
      cloud_account_id = data.spectrocloud_cloudaccount_custom.nutanix_account.id
      apply_setting    = "DownloadAndInstall"
      cluster_profile {
        id = data.spectrocloud_cluster_profile.profile.id
      }

      cloud_config {
        values = templatefile("config_templates/cloud_config.yaml", local.cloud_config_override_variables)
      }

      machine_pool {
        additional_labels = {
          "owner"   = "tf"
          "purpose" = "testing"
          "type"    = "cp"
        }
        control_plane           = true
        control_plane_as_worker = true
        node_pool_config        = templatefile("config_templates/cp_pool_config.yaml", local.node_pool_config_variables)
      }

      machine_pool {
        additional_labels = {
          "owner"   = "tf"
          "purpose" = "testing"
          "type"    = "worker"
        }
        control_plane           = false
        control_plane_as_worker = false
        taints {
          key    = "taintkey2"
          value  = "taintvalue2"
          effect = "NoSchedule"
        }
        node_pool_config = templatefile("config_templates/worker_pool_config.yaml", local.node_pool_config_variables)
      }

      cluster_rbac_binding {
        type = "ClusterRoleBinding"

        role = {
          kind = "ClusterRole"
          name = "testRole3"
        }
        subjects {
          type = "User"
          name = "testRoleUser3"
        }
        subjects {
          type = "Group"
          name = "testRoleGroup3"
        }
        subjects {
          type      = "ServiceAccount"
          name      = "testrolesubject3"
          namespace = "testrolenamespace"
        }
      }

      namespaces {
        name = "test5ns"
        resource_allocation = {
          cpu_cores  = "2"
          memory_MiB = "2048"
        }
      }
      backup_policy {
        schedule                  = "0 0 * * SUN"
        backup_location_id        = "test-backup-uid"
        prefix                    = "prod-backup"
        expiry_in_hour            = 7200
        include_disks             = false
        include_cluster_resources = true
      }

      scan_policy {
        configuration_scan_schedule = "0 0 * * SUN"
        penetration_scan_schedule   = "0 0 * * SUN"
        conformance_scan_schedule   = "0 0 1 * *"
      }

      pause_agent_upgrades = "lock"
      os_patch_on_boot  = true
      os_patch_schedule = "0 0 * * SUN"
      os_patch_after    = "2025-02-14T13:09:21+05:30"
      skip_completion   = true
      force_delete      = true
    }
```

## Import

In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import)
to import the resource spectrocloud_cluster_custom_cloud by using its `id` with the Palette `context` separated by a colon separated with `custom_cloud_name`. For example:

```terraform
import {
  to = spectrocloud_cluster_custom_cloud.example
  id = "example_id:context:custom_cloud_name"
}
```

Using `terraform import`, import the cluster using the `cluster_name` or `id` colon separated with `context` colon separated with `custom_cloud_name`. For example:

```console
terraform import spectrocloud_cluster_custom_cloud.{cloud_account_uid}/{cloud_account_name}:project:custom_cloud_name
```

Refer to the [Import section](/docs#import) to learn more.

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cloud` (String) The cloud provider name.
- `cloud_account_id` (String) The cloud account id to use for this cluster.
- `cloud_config` (Block List, Min: 1, Max: 1) The Cloud environment configuration settings such as network parameters and encryption parameters that apply to this cluster. (see [below for nested schema](#nestedblock--cloud_config))
- `machine_pool` (Block Set, Min: 1) The machine pool configuration for the cluster. (see [below for nested schema](#nestedblock--machine_pool))
- `name` (String) The name of the cluster.

### Optional

- `apply_setting` (String) The setting to apply the cluster profile. `DownloadAndInstall` will download and install packs in one action. `DownloadAndInstallLater` will only download artifact and postpone install for later. Default value is `DownloadAndInstall`.
- `backup_policy` (Block List, Max: 1) The backup policy for the cluster. If not specified, no backups will be taken. (see [below for nested schema](#nestedblock--backup_policy))
- `cluster_profile` (Block Set) (see [below for nested schema](#nestedblock--cluster_profile))
- `cluster_rbac_binding` (Block List) The RBAC binding for the cluster. (see [below for nested schema](#nestedblock--cluster_rbac_binding))
- `cluster_template` (Block List, Max: 1) The cluster template of the cluster. (see [below for nested schema](#nestedblock--cluster_template))
- `cluster_timezone` (String) Defines the time zone used by this cluster to interpret scheduled operations. Maintenance tasks like upgrades will follow this time zone to ensure they run at the appropriate local time for the cluster. Must be in IANA timezone format (e.g., 'America/New_York', 'Asia/Kolkata', 'Europe/London').
- `cluster_type` (String) The cluster type. Valid values are `PureManage` and `PureAttach`. This field can only be set during cluster creation and cannot be modified after the cluster is created. If not specified, the cluster will use the default type determined by the system.
- `context` (String) The context of the EKS cluster. Allowed values are `project` or `tenant`. Default is `project`. If  the `project` context is specified, the project name will sourced from the provider configuration parameter [`project_name`](https://registry.terraform.io/providers/spectrocloud/spectrocloud/latest/docs#schema).
- `description` (String) The description of the cluster. Default value is empty string.
- `force_delete` (Boolean) If set to `true`, the cluster will be force deleted and user has to manually clean up the provisioned cloud resources.
- `force_delete_delay` (Number) Delay duration in minutes to before invoking cluster force delete. Default and minimum is 20.
- `location_config` (Block List) (see [below for nested schema](#nestedblock--location_config))
- `namespaces` (Block List) The namespaces for the cluster. (see [below for nested schema](#nestedblock--namespaces))
- `os_patch_after` (String) Date and time after which to patch cluster `RFC3339: 2006-01-02T15:04:05Z07:00`
- `os_patch_on_boot` (Boolean) Whether to apply OS patch on boot. Default is `false`.
- `os_patch_schedule` (String) The cron schedule for OS patching. This must be in the form of cron syntax. Ex: `0 0 * * *`.
- `pause_agent_upgrades` (String) The pause agent upgrades setting allows to control the automatic upgrade of the Palette component and agent for an individual cluster. The default value is `unlock`, meaning upgrades occur automatically. Setting it to `lock` pauses automatic agent upgrades for the cluster.
- `scan_policy` (Block List, Max: 1) The scan policy for the cluster. (see [below for nested schema](#nestedblock--scan_policy))
- `skip_completion` (Boolean) If `true`, the cluster will be created asynchronously. Default value is `false`.
- `tags` (Set of String) A list of tags to be applied to the cluster. Tags must be in the form of `key:value`.
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))
- `update_worker_pools_in_parallel` (Boolean) Controls whether worker pool updates occur in parallel or sequentially. When set to `true` (default), all worker pools are updated simultaneously. When `false`, worker pools are updated one at a time, reducing cluster disruption but taking longer to complete updates.

### Read-Only

- `admin_kube_config` (String) Admin Kube-config for the cluster. This can be used to connect to the cluster using `kubectl`, With admin privilege.
- `cloud_config_id` (String, Deprecated)
- `id` (String) The ID of this resource.
- `kubeconfig` (String) Kubeconfig for the cluster. This can be used to connect to the cluster using `kubectl`.

<a id="nestedblock--cloud_config"></a>
### Nested Schema for `cloud_config`

Required:

- `values` (String) The values of the cloud config. The values are specified in YAML format.

Optional:

- `overrides` (Map of String) Key-value pairs to override specific values in the YAML. Supports template variables, wildcard patterns, field pattern search, document-specific and global overrides.

Template variables: Simple identifiers that replace ${var}, {{var}}, or $var patterns in YAML (e.g., 'cluster_name' replaces ${cluster_name})
Wildcard patterns: Patterns starting with '*' that match field names containing the specified substring (e.g., '*cluster-api-autoscaler-node-group-max-size' matches any field containing 'cluster-api-autoscaler-node-group-max-size')
Field pattern search: Patterns that find and update ALL matching nested fields anywhere in YAML (e.g., 'replicas' updates any 'replicas' field, 'rootVolume.size' updates any 'rootVolume.size' pattern)
Document-specific syntax: 'Kind.path' (e.g., 'Cluster.metadata.labels', 'AWSCluster.spec.region')
Global path syntax: 'path' (e.g., 'metadata.name', 'spec.region')

Processing order: 1) Template substitution, 2) Wildcard patterns, 3) Field pattern search, 4) Path-based overrides. Supports dot notation for nested paths and array indexing with [index]. Values are strings but support JSON syntax for arrays/objects.


<a id="nestedblock--machine_pool"></a>
### Nested Schema for `machine_pool`

Required:

- `node_pool_config` (String) The values of the node pool config. The values are specified in YAML format.

Optional:

- `control_plane` (Boolean) Whether this machine pool is a control plane. Defaults to `false`.
- `control_plane_as_worker` (Boolean) Whether this machine pool is a control plane and a worker. Defaults to `false`.
- `overrides` (Map of String) Key-value pairs to override specific values in the node pool config YAML. Supports template variables, wildcard patterns, field pattern search, document-specific and global overrides.

Template variables: Simple identifiers that replace ${var}, {{var}}, or $var patterns in YAML (e.g., 'node_count' replaces ${node_count})
Wildcard patterns: Patterns starting with '*' that match field names containing the specified substring (e.g., '*cluster-api-autoscaler-node-group-max-size' matches any field containing 'cluster-api-autoscaler-node-group-max-size')
Field pattern search: Patterns that find and update ALL matching nested fields anywhere in YAML (e.g., 'replicas' updates any 'replicas' field, 'rootVolume.size' updates any 'rootVolume.size' pattern)
Document-specific syntax: 'Kind.path' (e.g., 'AWSMachineTemplate.spec.template.spec.instanceType')
Global path syntax: 'path' (e.g., 'metadata.name', 'spec.instanceType')

Processing order: 1) Template substitution, 2) Wildcard patterns, 3) Field pattern search, 4) Path-based overrides. Supports dot notation for nested paths and array indexing with [index]. Values are strings but support JSON syntax for arrays/objects.
- `taints` (Block List) (see [below for nested schema](#nestedblock--machine_pool--taints))

Read-Only:

- `count` (Number) Number of nodes in the machine pool. This will be derived from the replica value in the 'node_pool_config'.
- `name` (String) The name of the machine pool. This will be derived from the name value in the `node_pool_config`.

<a id="nestedblock--machine_pool--taints"></a>
### Nested Schema for `machine_pool.taints`

Required:

- `effect` (String) The effect of the taint. Allowed values are: `NoSchedule`, `PreferNoSchedule` or `NoExecute`.
- `key` (String) The key of the taint.
- `value` (String) The value of the taint.



<a id="nestedblock--backup_policy"></a>
### Nested Schema for `backup_policy`

Required:

- `backup_location_id` (String) The ID of the backup location to use for the backup.
- `expiry_in_hour` (Number) The number of hours after which the backup will be deleted. For example, if the expiry is set to 24, the backup will be deleted after 24 hours.
- `prefix` (String) Prefix for the backup name. The backup name will be of the format <prefix>-<cluster-name>-<timestamp>.
- `schedule` (String) The schedule for the backup. The schedule is specified in cron format. For example, to run the backup every day at 1:00 AM, the schedule should be set to `0 1 * * *`.

Optional:

- `cluster_uids` (Set of String) The list of cluster UIDs to include in the backup. If `include_all_clusters` is set to `true`, then all clusters will be included.
- `include_all_clusters` (Boolean) Whether to include all clusters in the backup. If set to false, only the clusters specified in `cluster_uids` will be included.
- `include_cluster_resources` (Boolean) Indicates whether to include cluster resources in the backup. If set to false, only the cluster configuration and disks will be backed up. (Note: Starting with Palette version 4.6, the include_cluster_resources attribute will be deprecated, and a new attribute, include_cluster_resources_mode, will be introduced.)
- `include_cluster_resources_mode` (String) Specifies whether to include the cluster resources in the backup. Supported values are `always`, `never`, and `auto`.
- `include_disks` (Boolean) Whether to include the disks in the backup. If set to false, only the cluster configuration will be backed up.
- `namespaces` (Set of String) The list of Kubernetes namespaces to include in the backup. If not specified, all namespaces will be included.


<a id="nestedblock--cluster_profile"></a>
### Nested Schema for `cluster_profile`

Required:

- `id` (String) The ID of the cluster profile.

Optional:

- `pack` (Block List) For packs of type `spectro`, `helm`, and `manifest`, at least one pack must be specified. (see [below for nested schema](#nestedblock--cluster_profile--pack))
- `variables` (Map of String) A map of cluster profile variables, specified as key-value pairs. For example: `priority = "5"`.

<a id="nestedblock--cluster_profile--pack"></a>
### Nested Schema for `cluster_profile.pack`

Required:

- `name` (String) The name of the pack. The name must be unique within the cluster profile.

Optional:

- `manifest` (Block List) (see [below for nested schema](#nestedblock--cluster_profile--pack--manifest))
- `registry_name` (String) The registry name of the pack. The registry name is the human-readable name of the registry. This attribute can be used instead of `registry_uid` for better readability. If `uid` is not provided, this field can be used along with `name` and `tag` to resolve the pack UID internally. Either `registry_uid` or `registry_name` can be specified, but not both.
- `registry_uid` (String) The registry UID of the pack. The registry UID is the unique identifier of the registry. This attribute is required if there is more than one registry that contains a pack with the same name. If `uid` is not provided, this field is required along with `name` and `tag` to resolve the pack UID internally. Either `registry_uid` or `registry_name` can be specified, but not both.
- `tag` (String) The tag of the pack. The tag is the version of the pack. This attribute is required if the pack type is `spectro` or `helm`. If `uid` is not provided, this field is required along with `name` and `registry_uid` (or `registry_name`) to resolve the pack UID internally.
- `type` (String) The type of the pack. Allowed values are `spectro`, `manifest`, `helm`, or `oci`. The default value is spectro. If using an OCI registry for pack, set the type to `oci`.
- `uid` (String) The unique identifier of the pack. The value can be looked up using the [`spectrocloud_pack`](https://registry.terraform.io/providers/spectrocloud/spectrocloud/latest/docs/data-sources/pack) data source. This value is required if the pack type is `spectro` and for `helm` if the chart is from a public helm registry. If not provided, all of `name`, `tag`, and `registry_uid` must be specified to resolve the pack UID internally.
- `values` (String) The values of the pack. The values are the configuration values of the pack. The values are specified in YAML format.

<a id="nestedblock--cluster_profile--pack--manifest"></a>
### Nested Schema for `cluster_profile.pack.manifest`

Required:

- `content` (String) The content of the manifest. The content is the YAML content of the manifest.
- `name` (String) The name of the manifest. The name must be unique within the pack.

Read-Only:

- `uid` (String)




<a id="nestedblock--cluster_rbac_binding"></a>
### Nested Schema for `cluster_rbac_binding`

Required:

- `type` (String) The type of the RBAC binding. Can be one of the following values: `RoleBinding`, or `ClusterRoleBinding`.

Optional:

- `namespace` (String) The Kubernetes namespace of the RBAC binding. Required if 'type' is set to 'RoleBinding'.
- `role` (Map of String) The role of the RBAC binding. Required if 'type' is set to 'RoleBinding'. Must include 'name' and 'kind' fields.
- `subjects` (Block List) (see [below for nested schema](#nestedblock--cluster_rbac_binding--subjects))

<a id="nestedblock--cluster_rbac_binding--subjects"></a>
### Nested Schema for `cluster_rbac_binding.subjects`

Required:

- `name` (String) The name of the subject. Required if 'type' is set to 'User' or 'Group'.
- `type` (String) The type of the subject. Can be one of the following values: `User`, `Group`, or `ServiceAccount`.

Optional:

- `namespace` (String) The Kubernetes namespace of the subject. Required if 'type' is set to 'ServiceAccount'.



<a id="nestedblock--cluster_template"></a>
### Nested Schema for `cluster_template`

Required:

- `id` (String) The ID of the cluster template.

Optional:

- `cluster_profile` (Block Set) The cluster profile of the cluster template. (see [below for nested schema](#nestedblock--cluster_template--cluster_profile))

Read-Only:

- `name` (String) The name of the cluster template.

<a id="nestedblock--cluster_template--cluster_profile"></a>
### Nested Schema for `cluster_template.cluster_profile`

Required:

- `id` (String) The UID of the cluster profile.

Optional:

- `variables` (Map of String) A map of cluster profile variables, specified as key-value pairs. For example: `priority = "5"`.



<a id="nestedblock--location_config"></a>
### Nested Schema for `location_config`

Required:

- `latitude` (Number) The latitude coordinates value.
- `longitude` (Number) The longitude coordinates value.

Optional:

- `country_code` (String) The country code of the country the cluster is located in.
- `country_name` (String) The name of the country.
- `region_code` (String) The region code of where the cluster is located in.
- `region_name` (String) The name of the region.


<a id="nestedblock--namespaces"></a>
### Nested Schema for `namespaces`

Required:

- `name` (String) Name of the namespace. This is the name of the Kubernetes namespace in the cluster.
- `resource_allocation` (Map of String) Resource allocation for the namespace. This is a map containing the resource type and the resource value. For example, `{cpu_cores: '2', memory_MiB: '2048', gpu_limit: '1', gpu_provider: 'nvidia'}`


<a id="nestedblock--scan_policy"></a>
### Nested Schema for `scan_policy`

Required:

- `configuration_scan_schedule` (String) The schedule for configuration scan.
- `conformance_scan_schedule` (String) The schedule for conformance scan.
- `penetration_scan_schedule` (String) The schedule for penetration scan.


<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String)
- `delete` (String)
- `update` (String)